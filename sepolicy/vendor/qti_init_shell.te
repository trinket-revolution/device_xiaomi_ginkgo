allow qti_init_shell configfs:dir { write };
allow qti_init_shell sysfs_usbpd_device:file { setattr };

# Persist context hack
allow qti_init_shell persist_sensors_file:dir { read open search getattr relabelfrom relabelto };
allow qti_init_shell persist_sensors_file:file { read getattr relabelfrom relabelto };
allow qti_init_shell persist_sensors_file:fifo_file { read getattr relabelfrom relabelto };
allow qti_init_shell unlabeled:dir { read open search getattr relabelfrom relabelto };
allow qti_init_shell unlabeled:file { read getattr relabelfrom relabelto };
allow qti_init_shell unlabeled:fifo_file { read getattr relabelfrom relabelto };

allow qti_init_shell qti_init_shell:capability { dac_override };
allow qti_init_shell sysfs:file { write };

allow qti_init_shell default_prop:file { read };
allow qti_init_shell default_prop:file { open };
allow qti_init_shell default_prop:file { getattr };
allow qti_init_shell default_prop:file { map };
allow qti_init_shell system_file:file { execute getattr map open read };
allow qti_init_shell qti_init_shell:capability { kill };